%!TeX root=../thesis.tex
\tikzset{every picture/.style={line width=0.75pt}} % Set default line width to 0.75pt

\chapter{Implementation}

This section presents the implementation of the algorithm based on the work of \cite{Joos_2020}. For each step, we provide the corresponding pseudocode and demonstrate the correctness of the algorithm.

\section{Common Definitions}

Throughout this chapter, we use some abstract functions to streamline explanations. The total number of vertices is denoted by $n$, and the collection of graphs is represented by $G = \{G_1, G_2, \dots, G_n\}$, where each graph $G_i$ satisfies Dirac's condition.

\subsection{Structure of $edge(u, v, c)$}

Each edge in $G$ has three attributes:

\begin{itemize}
    \item $u$, $v$: vertices connected by the edge
    \item $c$: color of the edge, which also indicates that the edge belongs to graph $G_i$
\end{itemize}

\subsection{Structure of $Path$}

Each path contains two dynamic arrays:

\begin{itemize}
    \item $vertices$: an array of $vertex$
    \item $edges$: an array of $edge$
\end{itemize}

If the $Path$ is not empty, it is guaranteed that 
$vertices\text{.size()} = edges\text{.size()} + 1$. We 
also added the constraint that a $Path$ can't contain repeated 
vertices.

\subsection{Structure of $Cycle$}

Same Structure as $Path$. The only difference is that a cycle contains
at least two vertices and $vertices\text{.size()} = edges\text{.size()}$.

\subsection{Function $check\_edge(G, u, v, c)$}

This function takes four parameters:

\begin{itemize}
    \item $G$: the collection of graphs
    \item $u$: a vertex
    \item $v$: a vertex
    \item $c$: color of the edge
\end{itemize}

If the edge $\{u, v\}$ belongs to $G_c$, the function returns this edge. Otherwise, it returns $None$. The function operates in constant time $O(1)$ since we can implement it using a three-dimensional matrix, which requires $O(n^3)$ memory.

\section{Flowchart}

The algorithm begins with a single object representing an empty path. At 
each iteration, the algorithm processes this object, which may be either 
a path or a cycle of length $l$, and transforms it into a new object. 
The result could be a cycle of length $l$, a cycle of length $l+1$, or 
a path of length $l+1$, as shown in the flowchart below.

\begin{center}
    \begin{tikzpicture}[x=0.75pt,y=0.75pt,yscale=-1,xscale=1]
    % Rounded Rect [id:dp2247988663004169] 
    \draw   (100.6,84) .. controls (100.6,79.58) and (104.18,76) .. (108.6,76) -- (161.8,76) .. controls (166.22,76) and (169.8,79.58) .. (169.8,84) -- (169.8,108) .. controls (169.8,112.42) and (166.22,116) .. (161.8,116) -- (108.6,116) .. controls (104.18,116) and (100.6,112.42) .. (100.6,108) -- cycle ;
    % Rounded Rect [id:dp3322171879942837] 
    \draw   (220.6,84) .. controls (220.6,79.58) and (224.18,76) .. (228.6,76) -- (282.2,76) .. controls (286.62,76) and (290.2,79.58) .. (290.2,84) -- (290.2,108) .. controls (290.2,112.42) and (286.62,116) .. (282.2,116) -- (228.6,116) .. controls (224.18,116) and (220.6,112.42) .. (220.6,108) -- cycle ;
    % Rounded Rect [id:dp522325016929076] 
    \draw   (121.33,167.33) .. controls (121.33,162.92) and (124.92,159.33) .. (129.33,159.33) -- (261.67,159.33) .. controls (266.08,159.33) and (269.67,162.92) .. (269.67,167.33) -- (269.67,191.33) .. controls (269.67,195.75) and (266.08,199.33) .. (261.67,199.33) -- (129.33,199.33) .. controls (124.92,199.33) and (121.33,195.75) .. (121.33,191.33) -- cycle ;
    % Straight Lines [id:da4471732816066223] 
    \draw    (173.53,99) -- (214.87,99) ;
    \draw [shift={(216.87,99)}, rotate = 180] [color={rgb, 255:red, 0; green, 0; blue, 0 }  ][line width=0.75]    (10.93,-3.29) .. controls (6.95,-1.4) and (3.31,-0.3) .. (0,0) .. controls (3.31,0.3) and (6.95,1.4) .. (10.93,3.29)   ;
    % Straight Lines [id:da08077221270601986] 
    \draw    (140.6,119) -- (169.34,154.25) ;
    \draw [shift={(170.6,155.8)}, rotate = 230.81] [color={rgb, 255:red, 0; green, 0; blue, 0 }  ][line width=0.75]    (10.93,-3.29) .. controls (6.95,-1.4) and (3.31,-0.3) .. (0,0) .. controls (3.31,0.3) and (6.95,1.4) .. (10.93,3.29)   ;
    % Straight Lines [id:da17940502186011487] 
    \draw    (249,119.8) -- (221.05,154.64) ;
    \draw [shift={(219.8,156.2)}, rotate = 308.74] [color={rgb, 255:red, 0; green, 0; blue, 0 }  ][line width=0.75]    (10.93,-3.29) .. controls (6.95,-1.4) and (3.31,-0.3) .. (0,0) .. controls (3.31,0.3) and (6.95,1.4) .. (10.93,3.29)   ;

    % Text Nodes
    \draw (109.6,87.67) node [anchor=north west][inner sep=0.75pt]   [align=left] {$l$-path};
    \draw (227.6,87.27) node [anchor=north west][inner sep=0.75pt]   [align=left] {$l$-cycle};
    \draw (128.67,171) node [anchor=north west][inner sep=0.75pt]   [align=left] {$(l+1)$-path or cycle};
    \end{tikzpicture}
\end{center}

The algorithm considers two primary cases: when the object is a path and when it is a cycle.

\subsection{Path of Length $l$}

In this case, we start with a path \( P = \{x_1, e_1, \dots, x_{l}, e_{l}, x_{l + 1}\} \) of length \( l \). The goal is to find either a path of length \( l+1 \) or a cycle of length \( l \) or \( l+1 \). To assist in this process, we define the following variables:

\begin{itemize}
    \item \texttt{colors\_in\_path}: An array of size \( n \) where \texttt{colors\_in\_path[i]} is \texttt{True} if color \( i \) is used in the edges of the path.
    \item \texttt{vertices\_in\_path}: An array of size \( n \) where \texttt{vertices\_in\_path[i]} is \texttt{True} if vertex \( i \) is included in the path.
\end{itemize}

Let's divide the proof into two cases: when \( l \geq \left \lceil \frac{n}{2} \right \rceil \) and when \( l < \left \lceil \frac{n}{2} \right \rceil \).

\subsubsection{Case 1: \( l < \left \lceil \frac{n}{2} \right \rceil \)}

In this case, we select a color \( c \) that is not present among 
the edges of the current path. Since 
\( \deg(x_{l + 1}, c) \geq \left \lceil \frac{n}{2} \right \rceil \), 
and there are at most 
\( l < \left \lceil \frac{n}{2} \right \rceil \) 
vertices in the path, there must be a vertex 
\( y \) 
outside the path that is adjacent to 
\( x_{l + 1} \) via an edge in \( E(G_c) \). 
This guarantees that we can extend the path to a bigger path.

\begin{algorithm}[H]
    \caption{Path Extension for \( l < \left \lceil \frac{n}{2} \right \rceil \)}
    \begin{algorithmic}[1]
        \Function{Extend\_Path\_Small}{$G, P$}
        \State \textbf{assert} \( P.\text{size()} < \lceil \frac{n}{2} \rceil \)
        \State $last\_vertex \gets P.\text{back()}$
        \For{$color \in \{0, \dots, n-1\}$}
            \If{\textbf{not} $colors\_in\_path[color]$} \Comment{Search for an unused color}
                \For{$i \in \{0, \dots, n-1\}$}
                    \If{\textbf{not} $vertices\_in\_path[i]$} \Comment{Check vertices outside the path}
                        \State $edge \gets G.\text{check\_edge}(last\_vertex, i, color)$
                        \If{$edge \neq \text{None}$}
                            \State $vertices.\text{append}(i)$
                            \State $edges.\text{append}(edge)$
                            \State \Return Path($G$, $vertices$, $edges$) \Comment{Return extended path}
                        \EndIf
                    \EndIf
                \EndFor
            \EndIf
        \EndFor
        \State \textbf{assert False, "No valid extension found"}
    \EndFunction
    \end{algorithmic}
\end{algorithm}

The time complexity of this function is \( O(n) \). Since we 
only need to find a color that is not in the pathâ€™s colors 
,which takes \( O(n) \), and then locate a vertex outside 
the path that connects to the last vertex (also \( O(n) \)), 
the overall complexity remains linear in \( n \).

\subsubsection{Case 2: \( l \geq \left \lceil \frac{n}{2} \right \rceil \)}

First, remove the last edge and
vertex of the path and let $cx$ be a color that is not on the path and 
$cy$ be the color of the removed edge. We can check if the edge $\{x_1, x_{l}\}$ belongs to $G_{cx}$ or
to $G_{cy}$. If it does, we just found a cycle of size $l$. This can be done in $O(n)$ time complexity, the time need
to find a color outside the path and create the object Cycle. 


\begin{algorithm}[H]
    \caption{Part 1: Path Extension for \( l > \left \lceil \frac{n}{2} \right \rceil \)}
    \begin{algorithmic}
        \Function{Extend\_Path\_Big}{$G, P$}
            \State $cx \gets P.\text{edges}[-1].\text{color}$ \Comment{Color of the last edge in the path}
            \State $cy \gets \text{any color not in } colors\_in\_path$ \Comment{Find a color not in the path}
            \State $P.\text{pop\_back()}$ \Comment{Remove the last vertex from the path}
            \State $x \gets P.\text{vertices}[0]$ \Comment{First vertex in the path}
            \State $y \gets P.\text{vertices}[-1]$ \Comment{Last vertex in the updated path}

            \If{$edge \gets \text{check\_edge}(G, x, y, c) \neq \text{None}$}
                \State $vertices \gets P.\text{vertices.copy()}$
                \State $edges \gets P.\text{edges.copy()}$
                \State $edges.\text{append}(edge)$
                \State \Return Cycle($G$, $vertices$, $edges$) \Comment{Return cycle if found}
            \EndIf
        \EndFunction
    \end{algorithmic}
\end{algorithm}

We can now check if there exists a vertex $i$ outside the Path
such that $i$ is connects to the path on vertices $x_1$ and $x_l$
and uses colors $cx$ and $cy$, such as in the image below:

\begin{center}
    \tikzset{every picture/.style={line width=0.75pt}} %set default line width to 0.75pt        

    \begin{tikzpicture}[x=0.75pt,y=0.75pt,yscale=-1,xscale=1]
    %uncomment if require: \path (0,300); %set diagram left start at 0, and has height of 300
    
    %Shape: Circle [id:dp14076860311809425] 
    \draw  [color={rgb, 255:red, 0; green, 0; blue, 0 }  ,draw opacity=1 ] (100,135.88) .. controls (100,127.11) and (107.11,120) .. (115.88,120) .. controls (124.64,120) and (131.75,127.11) .. (131.75,135.88) .. controls (131.75,144.64) and (124.64,151.75) .. (115.88,151.75) .. controls (107.11,151.75) and (100,144.64) .. (100,135.88) -- cycle ;
    %Shape: Circle [id:dp9718918515389369] 
    \draw  [color={rgb, 255:red, 0; green, 0; blue, 0 }  ,draw opacity=1 ] (340,135.88) .. controls (340,127.11) and (347.11,120) .. (355.88,120) .. controls (364.64,120) and (371.75,127.11) .. (371.75,135.88) .. controls (371.75,144.64) and (364.64,151.75) .. (355.88,151.75) .. controls (347.11,151.75) and (340,144.64) .. (340,135.88) -- cycle ;
    %Shape: Circle [id:dp22152249244642985] 
    \draw  [color={rgb, 255:red, 0; green, 0; blue, 0 }  ,draw opacity=1 ] (170,135.88) .. controls (170,127.11) and (177.11,120) .. (185.88,120) .. controls (194.64,120) and (201.75,127.11) .. (201.75,135.88) .. controls (201.75,144.64) and (194.64,151.75) .. (185.88,151.75) .. controls (177.11,151.75) and (170,144.64) .. (170,135.88) -- cycle ;
    %Straight Lines [id:da5129055940889523] 
    \draw    (135,135) -- (165.5,135.25) ;
    %Straight Lines [id:da581278780757175] 
    \draw    (303.5,136) -- (334,136.25) ;
    %Shape: Circle [id:dp2164326053488742] 
    \draw  [color={rgb, 255:red, 0; green, 0; blue, 0 }  ,draw opacity=1 ] (263,135.88) .. controls (263,127.11) and (270.11,120) .. (278.88,120) .. controls (287.64,120) and (294.75,127.11) .. (294.75,135.88) .. controls (294.75,144.64) and (287.64,151.75) .. (278.88,151.75) .. controls (270.11,151.75) and (263,144.64) .. (263,135.88) -- cycle ;
    %Straight Lines [id:da9291156181154486] 
    \draw    (248.5,135.25) -- (258.5,135.25) ;
    %Straight Lines [id:da2577772310594443] 
    \draw    (205,136) -- (212.5,136.25) ;
    %Shape: Circle [id:dp2553341740528331] 
    \draw  [color={rgb, 255:red, 0; green, 0; blue, 0 }  ,draw opacity=1 ] (211.5,52.88) .. controls (211.5,44.11) and (218.61,37) .. (227.38,37) .. controls (236.14,37) and (243.25,44.11) .. (243.25,52.88) .. controls (243.25,61.64) and (236.14,68.75) .. (227.38,68.75) .. controls (218.61,68.75) and (211.5,61.64) .. (211.5,52.88) -- cycle ;
    %Straight Lines [id:da500585581947927] 
    \draw    (130.5,121.75) -- (211,65.75) ;
    %Straight Lines [id:da13872883018767035] 
    \draw    (338.5,120.25) -- (245,66.75) ;
    
    % Text Node
    \draw (109,131.4) node [anchor=north west][inner sep=0.75pt]    {$x_{1}$};
    % Text Node
    \draw (349,131.4) node [anchor=north west][inner sep=0.75pt]    {$x_{l}$};
    % Text Node
    \draw (179,131.4) node [anchor=north west][inner sep=0.75pt]    {$x_{2}$};
    % Text Node
    \draw (265.5,131.4) node [anchor=north west][inner sep=0.75pt]    {$x_{l-1}$};
    % Text Node
    \draw (221.5,124) node [anchor=north west][inner sep=0.75pt]   [align=left] {...};
    % Text Node
    \draw (144,137.9) node [anchor=north west][inner sep=0.75pt]    {$e_{1}$};
    % Text Node
    \draw (305.5,139.4) node [anchor=north west][inner sep=0.75pt]    {$e_{l\ -\ 1}$};
    % Text Node
    \draw (223.5,48.4) node [anchor=north west][inner sep=0.75pt]    {$i$};
    % Text Node
    \draw (125.5,73.4) node [anchor=north west][inner sep=0.75pt]    {$\textcolor[rgb]{0.29,0.56,0.89}{c_{x}}$};
    % Text Node
    \draw (321.5,73.4) node [anchor=north west][inner sep=0.75pt]    {$\textcolor[rgb]{0.29,0.56,0.89}{c}\textcolor[rgb]{0.29,0.56,0.89}{_{x}}$};
    % Text Node
    \draw (148.5,73.4) node [anchor=north west][inner sep=0.75pt]    {$\textcolor[rgb]{0.99,0.01,0.01}{c_{\textcolor[rgb]{0.98,0.03,0}{y}}}$};
    % Text Node
    \draw (142,73) node [anchor=north west][inner sep=0.75pt]   [align=left] {/};
    % Text Node
    \draw (296.5,73.4) node [anchor=north west][inner sep=0.75pt]    {$\textcolor[rgb]{0.99,0.01,0.01}{c}\textcolor[rgb]{0.99,0.01,0.01}{_{\textcolor[rgb]{0.98,0.03,0}{y}}}$};
    % Text Node
    \draw (314.5,73) node [anchor=north west][inner sep=0.75pt]   [align=left] {/};
    
    
    \end{tikzpicture}
    
\end{center}

This part can also be done on $O(n)$ time complexity with
the code below:

\begin{algorithm}[H]
    \caption{Part 3: Path Extension for \( l > \left \lceil \frac{n}{2} \right \rceil \)}
    \begin{algorithmic}
        \Function{Extend\_Path\_Big}{$G, P$}
            \For{$[c1, c2] \in [[cx, cy], [cy, cx]]$} \Comment{Try both color pairs}
                \For{$i \in \{0, \dots, n-1\}$}
                    \If{\textbf{not} $vertices\_in\_path[i]$} \Comment{Check vertices outside the path}
                        \State $edgeX \gets \text{check\_edge}(G, x, i, c1)$
                        \State $edgeY \gets \text{check\_edge}(G, y, i, c2)$
                        \If{$(edgeX \neq \text{None})$ and $(edgeY \neq \text{None})$}
                            \State $vertices \gets P.\text{vertices.copy()}$
                            \State $vertices.\text{append}(i)$
                            \State $edges \gets P.\text{edges.copy()}$
                            \State $edges.\text{append}(edgeY)$
                            \State $edges.\text{append}(edgeX)$
                            \State \Return Cycle($G$, $vertices$, $edges$) \Comment{Return cycle if found}
                        \EndIf
                    \EndIf
                \EndFor
            \EndFor

            \State \textbf{assert False, "No valid extension found"}
        \EndFunction
    \end{algorithmic}
\end{algorithm}

Let's define $I_1 = \{i \in [l - 2]: \{x_1, x_{i + 1}\} \in E_{G_cx}\}$ and 
$I_2 = \{i \in [2, l - 1]: \{x_i, x_{l}\} \in E_{G_cy}\}$. As 

Note that as we did not find a cycle yet, 

$$
|N_{G_cx}(x_1) \backslash V(P)| + |N_{G_cy}(x_l) \backslash V(P)| \leq n - l,
$$

otherwise, by Dirichlet Principle, we would have found a cycle
with the procedures above. Thus, we have that

$$
|I_1| + |I_2| \geq \frac{n}{2} + \frac{n}{2} - |N_{G_cx}(x_1) \backslash V(P)| - |N_{G_cy}(x_l) \backslash V(P)| \geq l.
$$

As we $I_1$ and $I_2$ share the same set of vertices of size
$l - 2$, $I_1 \cap I_2 \neq \emptyset$. Given an element
$i \in I_1 \cap I_2$, we can build a cycle with size $l$ with
the following crossing, removing edge $x_i$.

\begin{center}
\tikzset{every picture/.style={line width=0.75pt}} %set default line width to 0.75pt        

\begin{tikzpicture}[x=0.75pt,y=0.75pt,yscale=-1,xscale=1]
%uncomment if require: \path (0,300); %set diagram left start at 0, and has height of 300

%Shape: Circle [id:dp14076860311809425] 
\draw  [color={rgb, 255:red, 0; green, 0; blue, 0 }  ,draw opacity=1 ] (100,135.88) .. controls (100,127.11) and (107.11,120) .. (115.88,120) .. controls (124.64,120) and (131.75,127.11) .. (131.75,135.88) .. controls (131.75,144.64) and (124.64,151.75) .. (115.88,151.75) .. controls (107.11,151.75) and (100,144.64) .. (100,135.88) -- cycle ;
%Shape: Circle [id:dp9718918515389369] 
\draw  [color={rgb, 255:red, 0; green, 0; blue, 0 }  ,draw opacity=1 ] (496.5,135.88) .. controls (496.5,127.11) and (503.61,120) .. (512.38,120) .. controls (521.14,120) and (528.25,127.11) .. (528.25,135.88) .. controls (528.25,144.64) and (521.14,151.75) .. (512.38,151.75) .. controls (503.61,151.75) and (496.5,144.64) .. (496.5,135.88) -- cycle ;
%Shape: Circle [id:dp22152249244642985] 
\draw  [color={rgb, 255:red, 0; green, 0; blue, 0 }  ,draw opacity=1 ] (170,135.88) .. controls (170,127.11) and (177.11,120) .. (185.88,120) .. controls (194.64,120) and (201.75,127.11) .. (201.75,135.88) .. controls (201.75,144.64) and (194.64,151.75) .. (185.88,151.75) .. controls (177.11,151.75) and (170,144.64) .. (170,135.88) -- cycle ;
%Straight Lines [id:da5129055940889523] 
\draw    (135,135) -- (165.5,135.25) ;
%Straight Lines [id:da581278780757175] 
\draw    (460,136) -- (490.5,136.25) ;
%Shape: Circle [id:dp2164326053488742] 
\draw  [color={rgb, 255:red, 0; green, 0; blue, 0 }  ,draw opacity=1 ] (419.5,135.88) .. controls (419.5,127.11) and (426.61,120) .. (435.38,120) .. controls (444.14,120) and (451.25,127.11) .. (451.25,135.88) .. controls (451.25,144.64) and (444.14,151.75) .. (435.38,151.75) .. controls (426.61,151.75) and (419.5,144.64) .. (419.5,135.88) -- cycle ;
%Straight Lines [id:da9291156181154486] 
\draw    (405,135.25) -- (415,135.25) ;
%Straight Lines [id:da2577772310594443] 
\draw    (205,136) -- (212.5,136.25) ;
%Shape: Circle [id:dp8825188362565558] 
\draw  [color={rgb, 255:red, 0; green, 0; blue, 0 }  ,draw opacity=1 ] (251,135.88) .. controls (251,127.11) and (258.11,120) .. (266.88,120) .. controls (275.64,120) and (282.75,127.11) .. (282.75,135.88) .. controls (282.75,144.64) and (275.64,151.75) .. (266.88,151.75) .. controls (258.11,151.75) and (251,144.64) .. (251,135.88) -- cycle ;
%Shape: Circle [id:dp9134750344031234] 
\draw  [color={rgb, 255:red, 0; green, 0; blue, 0 }  ,draw opacity=1 ] (321,135.88) .. controls (321,127.11) and (328.11,120) .. (336.88,120) .. controls (345.64,120) and (352.75,127.11) .. (352.75,135.88) .. controls (352.75,144.64) and (345.64,151.75) .. (336.88,151.75) .. controls (328.11,151.75) and (321,144.64) .. (321,135.88) -- cycle ;
%Straight Lines [id:da6587077764610608] 
\draw    (356,136) -- (363.5,136.25) ;
%Straight Lines [id:da08873759090043654] 
\draw    (239,137) -- (246.5,137.25) ;
%Curve Lines [id:da934768158738368] 
\draw    (123,112.25) .. controls (163,82.25) and (295,83) .. (333,112.25) ;
%Curve Lines [id:da06750067448598662] 
\draw    (283,110.75) .. controls (323,80.75) and (455,81.5) .. (493,110.75) ;

% Text Node
\draw (109,131.4) node [anchor=north west][inner sep=0.75pt]    {$x_{1}$};
% Text Node
\draw (505.5,131.4) node [anchor=north west][inner sep=0.75pt]    {$x_{l}$};
% Text Node
\draw (179,131.4) node [anchor=north west][inner sep=0.75pt]    {$x_{2}$};
% Text Node
\draw (422,131.4) node [anchor=north west][inner sep=0.75pt]    {$x_{l-1}$};
% Text Node
\draw (378,124) node [anchor=north west][inner sep=0.75pt]   [align=left] {...};
% Text Node
\draw (144,137.9) node [anchor=north west][inner sep=0.75pt]    {$e_{1}$};
% Text Node
\draw (462,139.4) node [anchor=north west][inner sep=0.75pt]    {$e_{l\ -\ 1}$};
% Text Node
\draw (216,63.4) node [anchor=north west][inner sep=0.75pt]    {$\textcolor[rgb]{0.29,0.56,0.89}{c_{x}}$};
% Text Node
\draw (381,61.9) node [anchor=north west][inner sep=0.75pt]    {$\textcolor[rgb]{0.99,0.01,0.01}{c_{\textcolor[rgb]{0.98,0.03,0}{y}}}$};
% Text Node
\draw (219,125.5) node [anchor=north west][inner sep=0.75pt]   [align=left] {...};
% Text Node
\draw (260,131.4) node [anchor=north west][inner sep=0.75pt]    {$x_{i}$};
% Text Node
\draw (325,131.4) node [anchor=north west][inner sep=0.75pt]    {$x_{i+1}$};


\end{tikzpicture}

\end{center}

Then, for this case, we just need to find an intersection
for $I_1$ and $I_2$ and build the solution. This can also
be done in $O(n)$ with the code below:

\begin{algorithm}[H]
    \caption{Part 3: Path Extension for \( l > \left \lceil \frac{n}{2} \right \rceil \)}
    \begin{algorithmic}[1]
        \Function{Extend\_Path\_Big}{$G, P$}
            \For{$i \gets 1$ to $|P.\text{vertices}| - 2$}
                \State $u \gets P.\text{vertices}[i]$
                \State $v \gets P.\text{vertices}[i + 1]$
                \State $edgeX \gets \text{check\_edge}(G, x, v, cx)$
                \State $edgeY \gets G.\text{check\_edge}(G, u, y, cy)$

                \If{$(edgeX \neq \text{None})$ and $(edgeY \neq \text{None})$} 
                    \State $vertices \gets P.\text{vertices}[1:i] + [y] + \text{Reverse}(P.\text{vertices}[i + 1:l])$
                    \State $edges \gets P.\text{edges}[1:i - 1] + [edgeY]$

                    \For{$j \gets |P.\text{vertices}| - 1$ down to $i + 1$}
                        \State $vertices.\text{append}(P.\text{vertices}[j - 1])$
                        \State $edges.\text{append}(P.\text{edges}[j - 1])$
                    \EndFor
                    \State $edges.\text{append}(edgeX)$ \Comment{Add $edgeX$ to close the cycle}
                    \State \Return Cycle($G$, $vertices$, $edges$)
                \EndIf
            \EndFor
            \State \Return \text{None} \Comment{Return None if no cycle found}
        \EndFunction
    \end{algorithmic}
\end{algorithm}



\subsection{Cycle of length $n - 1 \neq \ell \geq \left \lfloor \frac{n}{2} \right \rfloor$}

\section{Cycle of length $n - 1$}


